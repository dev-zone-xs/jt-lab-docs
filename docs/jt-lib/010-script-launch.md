---
id: script-launch
title: Запуск скрипта
sidebar_label: Запуск скрипта
---

# Запуск скрипта

Для запуска торгового скрипта в JT-Trader необходимо создать сценарий (runtime), который будет запускать класс Script, определенный в файле стратегии.

## Как это работает

1. **В JT-Trader** вы создаете сценарий (runtime) с настройками
2. **Сценарий** указывает на файл с классом Script
3. **При запуске** JT-Trader выполняет класс Script из указанного файла
4. **Класс Script** наследуется от BaseScript и содержит логику торговой стратегии

## Создание сценария в JT-Trader

### 1. Переход на вкладку Runtime

В интерфейсе JT-Trader перейдите на вкладку Runtime, где отображаются все запущенные и остановленные торговые скрипты.

### 2. Создание нового сценария

Нажмите кнопку **Create Runtime** для создания нового сценария запуска скрипта.

![Create Runtime Screenshot](/images/create-scanerio-runtime.jpg)

### 3. Настройка параметров сценария

При создании сценария необходимо указать следующие обязательные параметры:

**Основные параметры:**
- **Name** - Название сценария для идентификации
- **Script** - Файл торгового скрипта

**Параметры подключения:**
- **Connection** - Выберите подключение к бирже из списка доступных соединений
- **Symbols** - Список торговых пар, разделенных запятыми (например: `BTC/USDT:USDT,ETH/USDT:USDT,ADA/USDT:USDT`)

### 4. Пользовательские параметры

В разделе **Parameters** вы можете добавить пользовательские параметры, которые будут переданы в скрипт. Эти параметры настраиваются разработчиком скрипта и могут включать цены покупки/продажи, объемы торговли, настройки стоп-лосса и другие параметры стратегии.

### 5. Сохранение и запуск

После настройки всех параметров нажмите кнопку **Save** для сохранения сценария, а затем кнопку **Run** для запуска скрипта. При запуске скрипту будут переданы все указанные параметры подключения, а также пользовательские параметры, если они были добавлены.

## Что происходит при запуске

После нажатия кнопки **Run** JT-Trader выполняет следующие действия:

1. **Подключается к бирже** - Устанавливает WebSocket соединение с выбранной биржей
2. **Подписывается на события** - Подписывается на следующие события:
   - **Изменение баланса** - Получение обновлений о состоянии счета
   - **Приход котировок** - Получение новых тиков по указанным символам
   - **Изменение позиций** - Отслеживание открытых позиций
   - **Изменение ордеров** - Мониторинг статуса всех ордеров
3. **Загружает файл** - Читает указанный файл  
4. **Находит класс Script** - Ищет класс, и создает его в окружении 
5. **Создает экземпляр** - Создает объект этого класса
6. **Передает параметры** - Передает все настройки сценария в скрипт
7. **Запускает выполнение** - Начинает выполнение методов жизненного цикла

## Класс Script в файле стратегии

В файле стратегии должен быть определен класс Script, который наследуется от BaseScript. Этот класс содержит всю логику торговой стратегии.

### Структура класса Script

```typescript
class Script extends BaseScript {
  // Параметры стратегии
  private buyPrice: number;
  private sellPrice: number;
  private volume: number;

  // Инициализация стратегии
  async onInit() {
    // Получение пользовательских параметров
    this.buyPrice = getArgNumber('buyPrice', 50000);
    this.sellPrice = getArgNumber('sellPrice', 55000);
    this.volume = getArgNumber('volume', 0.001);
    
    console.log('Стратегия инициализирована');
    console.log(`Подключение: ${this.connectionName}`);
    console.log(`Символы: ${this.symbols.join(', ')}`);
  }

  // Обработка новых тиков (только для первого символа)
  async onTick(data: Tick) {
    const currentPrice = data.close;
    
    // Логика торговой стратегии
    if (currentPrice <= this.buyPrice) {
      await this.buyMarket(this.volume);
      console.log(`Купили по цене: ${currentPrice}`);
    }
  }

  // Обработка изменений ордеров
  async onOrderChange(order: Order) {
    console.log(`Ордер ${order.id}: ${order.status}`);
  }

  // Завершение работы
  async onStop() {
    console.log('Стратегия остановлена');
  }
}
```
